<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Угадай число</title>
<style>
    body { text-align: center; font-family: Arial, sans-serif; margin-top: 50px; background-color: #222; color: #fff; }
    #line { width: 100px; height: 10px; background: blue; position: absolute; margin: 50px; }
    input, button { font-size: 16px; margin: 5px; padding: 5px; }
    #message { font-size: 18px; margin-top: 20px; }
    #result { font-size: 18px; margin-top: 30px; color: #FFD700; }
    #modal { display: none; background: rgba(0,0,0,0.7); color: white; padding: 20px; position: absolute; top: 30%; left: 50%; transform: translateX(-50%); border-radius: 10px; text-align: center; }
    #coins { position: fixed; top: 20px; right: 20px; font-size: 24px; color: gold; }
    #record { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); font-size: 18px; color: #FFD700; }
</style>
</head>
<body>

<h1>Угадай число от 1 до 100</h1>

<input type="text" id="guessInput" placeholder="Введите число">
<button onclick="checkGuess()">Проверить</button>
<p id="message"></p>

<div id="line"></div>

<!-- Модальное окно с результатами -->
<div id="modal">
    <h2>Результаты</h2>
    <p id="result"></p>
    <button onclick="closeModal()">Закрыть</button>
</div>

<div id="coins">Монеты: 0</div>
<div id="record">Рекорд: Время - 0s, Ошибки - 0</div>

<script>
let number = Math.floor(Math.random() * 100) + 1; // случайное число
let line = document.getElementById('line');
let pos = 0;
let dx = 1; // начальная скорость (очень медленная)
let maxWidth = window.innerWidth - 120;
let maxHeight = window.innerHeight - 20; // для движения змейки по вертикали
let errorCount = 0; // счётчик ошибок
let startTime = Date.now(); // время начала игры
let gameFinished = false; // флаг для завершения игры
let coins = 0; // количество монет
let oldRecord = { time: 0, errors: 0 }; // рекорд

// Двигаем змейку по всему экрану
function moveLine() {
    pos += dx;
    if (pos > maxWidth || pos < 0) dx = -dx;
    let randomVertical = Math.random() * maxHeight; // случайное вертикальное положение
    line.style.left = pos + "px";
    line.style.top = randomVertical + "px"; // обновляем вертикальную позицию
    requestAnimationFrame(moveLine);
}
moveLine();

function checkGuess() {
    if (gameFinished) return; // если игра закончена, не обрабатываем новые попытки

    let guess = document.getElementById('guessInput').value.trim().toLowerCase(); // получаем введённый текст
    let message = document.getElementById('message');

    // Чит-код
    if (guess === "валера") {
        message.textContent = "Ты активировал чит-код! Победа!";
        line.style.background = "green";
        gameFinished = true;
        let endTime = Date.now();
        let timeTaken = (endTime - startTime) / 1000; // время в секундах
        showModal(timeTaken, errorCount);
        return;
    }

    // Если введено не число
    if (isNaN(guess)) {
        message.textContent = "Введите число!";
        return;
    }

    guess = parseInt(guess); // преобразуем в число

    errorCount++; // увеличиваем количество ошибок

    if (guess === number) {
        message.textContent = "Молодец! Угадал!";
        line.style.background = "green";
        dx = 3; // сброс скорости
        gameFinished = true;

        // Вычисление времени
        let endTime = Date.now();
        let timeTaken = (endTime - startTime) / 1000; // время в секундах

        // Показываем результат
        showModal(timeTaken, errorCount);
        coins += 10; // начисляем монеты
        document.getElementById('coins').textContent = `Монеты: ${coins}`;
    } else {
        message.textContent = "Не угадал! Попробуй ещё!";
        line.style.background = "red"; // линия становится красной
        setTimeout(() => {
            line.style.background = "blue"; // через несколько секунд она снова станет синей
        }, 500); // возвращается через 0.5 секунды
        dx += 1; // линия ускоряется
    }

    document.getElementById('guessInput').value = "";
}

// Функция для отображения модального окна
function showModal(time, errors) {
    let resultText = `Вы угадали число за ${time.toFixed(2)} секунд с ${errors} ошибками.`;
    document.getElementById('result').textContent = resultText;
    document.getElementById('modal').style.display = 'block';

    // Обновляем рекорд
    if (time < oldRecord.time || oldRecord.time === 0) {
        oldRecord.time = time;
        oldRecord.errors = errors;
    }

    // Показываем старый рекорд
    document.getElementById('record').textContent = `Рекорд: Время - ${oldRecord.time.toFixed(2)}s, Ошибки - ${oldRecord.errors}`;
}

// Функция для закрытия модального окна
function closeModal() {
    document.getElementById('modal').style.display = 'none';
    // Перезапускаем игру
    resetGame();
}

// Функция для перезапуска игры
function resetGame() {
    number = Math.floor(Math.random() * 100) + 1; // новое число
    errorCount = 0; // сброс ошибок
    startTime = Date.now(); // сброс времени
    gameFinished = false; // сброс флага игры
    line.style.background = 'blue'; // сброс цвета линии
    dx = 1; // сброс скорости (медленно)
    document.getElementById('message').textContent = ""; // очистка сообщения
}
</script>

</body>
</html>
